{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\admin\\\\OneDrive\\\\Bureau\\\\codes folder\\\\fd github\\\\food-deliver-app\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\admin\\\\OneDrive\\\\Bureau\\\\codes folder\\\\fd github\\\\food-deliver-app\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:\\\\Users\\\\admin\\\\OneDrive\\\\Bureau\\\\codes folder\\\\fd github\\\\food-deliver-app\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\admin\\\\OneDrive\\\\Bureau\\\\codes folder\\\\fd github\\\\food-deliver-app\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\admin\\\\OneDrive\\\\Bureau\\\\codes folder\\\\fd github\\\\food-deliver-app\\\\front-end\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import{Grid,Typography,Button}from'@material-ui/core';import React from'react';import OrderCard from\"../../card/OrderCard\";var axios=require('axios').default;var ShopCart=/*#__PURE__*/function(_React$Component){_inherits(ShopCart,_React$Component);var _super=_createSuper(ShopCart);function ShopCart(props){var _this;_classCallCheck(this,ShopCart);_this=_super.call(this,props);_this.state={orders:undefined,isCheckingOut:false,checkoutError:null,isLoading:true};_this.getCartOrders=_this.getCartOrders.bind(_assertThisInitialized(_this));_this.checkout=_this.checkout.bind(_assertThisInitialized(_this));_this.calculateTotal=_this.calculateTotal.bind(_assertThisInitialized(_this));return _this;}_createClass(ShopCart,[{key:\"componentDidMount\",value:function componentDidMount(){this.getCartOrders();}},{key:\"getCartOrders\",value:function getCartOrders(){var _this2=this;this.setState({isLoading:true});axios.get(\"/api/customer/myCart/\"+this.props.currentUser.id).then(function(response){_this2.setState({orders:response.data,isLoading:false,checkoutError:null});}).catch(function(err){console.log(err);_this2.setState({isLoading:false,checkoutError:'Failed to load cart items.'});});}},{key:\"calculateTotal\",value:function calculateTotal(){return this.state.orders.reduce(function(sum,order){return sum+order.price*order.quantity;},0);}},{key:\"checkout\",value:function checkout(){var _this3=this;if(!this.state.orders||this.state.orders.length===0){this.setState({checkoutError:'Your cart is empty.'});return;}var total=this.calculateTotal();if(total<=0){this.setState({checkoutError:'Invalid order total.'});return;}this.setState({isCheckingOut:true,checkoutError:null});axios.post(\"/api/order/checkoutAll\",{orders:this.state.orders,total:total}).then(function(response){_this3.setState({isCheckingOut:false});if(response.data&&response.status===200){alert('Orders successfully checked out!');_this3.getCartOrders();}}).catch(function(err){var _err$response,_err$response$data;console.log(err);var errorMessage=((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||'Error during checkout. Please try again.';_this3.setState({isCheckingOut:false,checkoutError:errorMessage});});}},{key:\"render\",value:function render(){var _this4=this;if(this.state.isLoading){return/*#__PURE__*/React.createElement(Typography,null,\"Loading cart...\");}return this.props.currentUser&&this.state.orders?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Grid,{container:true,justify:\"space-evenly\",spacing:3},this.state.orders.length>0?this.state.orders.map(function(order){return/*#__PURE__*/React.createElement(Grid,{item:true,key:order.id,xs:5},/*#__PURE__*/React.createElement(OrderCard,{order:order,userType:_this4.props.currentUser.type,getOrders:_this4.getCartOrders}));}):/*#__PURE__*/React.createElement(Typography,{variant:\"h5\"},/*#__PURE__*/React.createElement(\"i\",null,\"Your Shopping Cart is Empty...\")),this.state.orders.length>0&&/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(\"div\",{className:\"checkoutBox\"},/*#__PURE__*/React.createElement(Grid,{container:true,justify:\"flex-end\",spacing:2},/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(Typography,{variant:\"h6\",align:\"right\"},\"Total: $\",this.calculateTotal().toFixed(2))),this.state.checkoutError&&/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(Typography,{color:\"error\",align:\"right\"},this.state.checkoutError)),/*#__PURE__*/React.createElement(Grid,{item:true},/*#__PURE__*/React.createElement(Button,{variant:\"outlined\",color:\"secondary\",size:\"medium\",onClick:this.checkout,disabled:this.state.isCheckingOut||this.state.orders.length===0},this.state.isCheckingOut?'Processing...':'Check out all orders'))))))):/*#__PURE__*/React.createElement(\"div\",null);}}]);return ShopCart;}(React.Component);export default ShopCart;","map":{"version":3,"sources":["C:/Users/admin/OneDrive/Bureau/codes folder/fd github/food-deliver-app/front-end/src/components/customerView/mainpage/ShopCart.jsx"],"names":["Grid","Typography","Button","React","OrderCard","axios","require","default","ShopCart","props","state","orders","undefined","isCheckingOut","checkoutError","isLoading","getCartOrders","bind","checkout","calculateTotal","setState","get","currentUser","id","then","response","data","catch","err","console","log","reduce","sum","order","price","quantity","length","total","post","status","alert","errorMessage","message","map","type","toFixed","Component"],"mappings":"oiCAAA,OAASA,IAAT,CAAeC,UAAf,CAA2BC,MAA3B,KAAyC,mBAAzC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,SAAP,KAAsB,sBAAtB,CACA,GAAMC,CAAAA,KAAK,CAAGC,OAAO,CAAC,OAAD,CAAP,CAAiBC,OAA/B,C,GAEMC,CAAAA,Q,gHACJ,kBAAYC,KAAZ,CAAmB,0CACjB,uBAAMA,KAAN,EACA,MAAKC,KAAL,CAAa,CACXC,MAAM,CAAEC,SADG,CAEXC,aAAa,CAAE,KAFJ,CAGXC,aAAa,CAAE,IAHJ,CAIXC,SAAS,CAAE,IAJA,CAAb,CAMA,MAAKC,aAAL,CAAqB,MAAKA,aAAL,CAAmBC,IAAnB,+BAArB,CACA,MAAKC,QAAL,CAAgB,MAAKA,QAAL,CAAcD,IAAd,+BAAhB,CACA,MAAKE,cAAL,CAAsB,MAAKA,cAAL,CAAoBF,IAApB,+BAAtB,CAViB,aAWlB,C,kFAEmB,CAClB,KAAKD,aAAL,GACD,C,qDAEe,iBACd,KAAKI,QAAL,CAAc,CAAEL,SAAS,CAAE,IAAb,CAAd,EACAV,KAAK,CAACgB,GAAN,CAAU,wBAA0B,KAAKZ,KAAL,CAAWa,WAAX,CAAuBC,EAA3D,EACGC,IADH,CACQ,SAAAC,QAAQ,CAAI,CAChB,MAAI,CAACL,QAAL,CAAc,CACZT,MAAM,CAAEc,QAAQ,CAACC,IADL,CAEZX,SAAS,CAAE,KAFC,CAGZD,aAAa,CAAE,IAHH,CAAd,EAKD,CAPH,EAQGa,KARH,CAQS,SAAAC,GAAG,CAAI,CACZC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACA,MAAI,CAACR,QAAL,CAAc,CACZL,SAAS,CAAE,KADC,CAEZD,aAAa,CAAE,4BAFH,CAAd,EAID,CAdH,EAeD,C,uDAEgB,CACf,MAAO,MAAKJ,KAAL,CAAWC,MAAX,CAAkBoB,MAAlB,CAAyB,SAACC,GAAD,CAAMC,KAAN,QAAgBD,CAAAA,GAAG,CAAIC,KAAK,CAACC,KAAN,CAAcD,KAAK,CAACE,QAA3C,EAAzB,CAA+E,CAA/E,CAAP,CACD,C,2CAEU,iBACT,GAAI,CAAC,KAAKzB,KAAL,CAAWC,MAAZ,EAAsB,KAAKD,KAAL,CAAWC,MAAX,CAAkByB,MAAlB,GAA6B,CAAvD,CAA0D,CACxD,KAAKhB,QAAL,CAAc,CAAEN,aAAa,CAAE,qBAAjB,CAAd,EACA,OACD,CAED,GAAMuB,CAAAA,KAAK,CAAG,KAAKlB,cAAL,EAAd,CACA,GAAIkB,KAAK,EAAI,CAAb,CAAgB,CACd,KAAKjB,QAAL,CAAc,CAAEN,aAAa,CAAE,sBAAjB,CAAd,EACA,OACD,CAED,KAAKM,QAAL,CAAc,CAAEP,aAAa,CAAE,IAAjB,CAAuBC,aAAa,CAAE,IAAtC,CAAd,EACAT,KAAK,CAACiC,IAAN,CAAW,wBAAX,CAAqC,CACnC3B,MAAM,CAAE,KAAKD,KAAL,CAAWC,MADgB,CAEnC0B,KAAK,CAAEA,KAF4B,CAArC,EAICb,IAJD,CAIM,SAAAC,QAAQ,CAAI,CAChB,MAAI,CAACL,QAAL,CAAc,CAAEP,aAAa,CAAE,KAAjB,CAAd,EACA,GAAIY,QAAQ,CAACC,IAAT,EAAiBD,QAAQ,CAACc,MAAT,GAAoB,GAAzC,CAA8C,CAC5CC,KAAK,CAAC,kCAAD,CAAL,CACA,MAAI,CAACxB,aAAL,GACD,CACF,CAVD,EAWCW,KAXD,CAWO,SAAAC,GAAG,CAAI,sCACZC,OAAO,CAACC,GAAR,CAAYF,GAAZ,EACA,GAAMa,CAAAA,YAAY,CAAG,gBAAAb,GAAG,CAACH,QAAJ,0EAAcC,IAAd,gEAAoBgB,OAApB,GAA+B,0CAApD,CACA,MAAI,CAACtB,QAAL,CAAc,CACZP,aAAa,CAAE,KADH,CAEZC,aAAa,CAAE2B,YAFH,CAAd,EAID,CAlBD,EAmBD,C,uCAEQ,iBACP,GAAI,KAAK/B,KAAL,CAAWK,SAAf,CAA0B,CACxB,mBAAO,oBAAC,UAAD,wBAAP,CACD,CAED,MAAO,MAAKN,KAAL,CAAWa,WAAX,EAA0B,KAAKZ,KAAL,CAAWC,MAArC,cACL,4CACE,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,OAAO,CAAC,cAAxB,CAAuC,OAAO,CAAE,CAAhD,EACG,KAAKD,KAAL,CAAWC,MAAX,CAAkByB,MAAlB,CAA2B,CAA3B,CAA+B,KAAK1B,KAAL,CAAWC,MAAX,CAAkBgC,GAAlB,CAAsB,SAAAV,KAAK,qBACzD,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,GAAG,CAAEA,KAAK,CAACV,EAAtB,CAA0B,EAAE,CAAE,CAA9B,eACE,oBAAC,SAAD,EAAW,KAAK,CAAEU,KAAlB,CAAyB,QAAQ,CAAE,MAAI,CAACxB,KAAL,CAAWa,WAAX,CAAuBsB,IAA1D,CAAgE,SAAS,CAAE,MAAI,CAAC5B,aAAhF,EADF,CADyD,EAA3B,CAA/B,cAII,oBAAC,UAAD,EAAY,OAAO,CAAC,IAApB,eAAyB,8DAAzB,CALP,CAMG,KAAKN,KAAL,CAAWC,MAAX,CAAkByB,MAAlB,CAA2B,CAA3B,eACC,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,EAAf,eACE,2BAAK,SAAS,CAAC,aAAf,eACE,oBAAC,IAAD,EAAM,SAAS,KAAf,CAAgB,OAAO,CAAC,UAAxB,CAAmC,OAAO,CAAE,CAA5C,eACE,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,EAAf,eACE,oBAAC,UAAD,EAAY,OAAO,CAAC,IAApB,CAAyB,KAAK,CAAC,OAA/B,aACW,KAAKjB,cAAL,GAAsB0B,OAAtB,CAA8B,CAA9B,CADX,CADF,CADF,CAMG,KAAKnC,KAAL,CAAWI,aAAX,eACC,oBAAC,IAAD,EAAM,IAAI,KAAV,CAAW,EAAE,CAAE,EAAf,eACE,oBAAC,UAAD,EAAY,KAAK,CAAC,OAAlB,CAA0B,KAAK,CAAC,OAAhC,EACG,KAAKJ,KAAL,CAAWI,aADd,CADF,CAPJ,cAaE,oBAAC,IAAD,EAAM,IAAI,KAAV,eACE,oBAAC,MAAD,EACE,OAAO,CAAC,UADV,CAEE,KAAK,CAAC,WAFR,CAGE,IAAI,CAAC,QAHP,CAIE,OAAO,CAAE,KAAKI,QAJhB,CAKE,QAAQ,CAAE,KAAKR,KAAL,CAAWG,aAAX,EAA4B,KAAKH,KAAL,CAAWC,MAAX,CAAkByB,MAAlB,GAA6B,CALrE,EAOG,KAAK1B,KAAL,CAAWG,aAAX,CAA2B,eAA3B,CAA6C,sBAPhD,CADF,CAbF,CADF,CADF,CAPJ,CADF,CADK,cAyCH,+BAzCJ,CA0CD,C,sBA1HoBV,KAAK,CAAC2C,S,EA6H7B,cAAetC,CAAAA,QAAf","sourcesContent":["import { Grid, Typography, Button } from '@material-ui/core';\r\nimport React from 'react';\r\nimport OrderCard from \"../../card/OrderCard\";\r\nconst axios = require('axios').default;\r\n\r\nclass ShopCart extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      orders: undefined,\r\n      isCheckingOut: false,\r\n      checkoutError: null,\r\n      isLoading: true\r\n    }\r\n    this.getCartOrders = this.getCartOrders.bind(this);\r\n    this.checkout = this.checkout.bind(this);\r\n    this.calculateTotal = this.calculateTotal.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getCartOrders();\r\n  }\r\n\r\n  getCartOrders() {\r\n    this.setState({ isLoading: true });\r\n    axios.get(\"/api/customer/myCart/\" + this.props.currentUser.id)\r\n      .then(response => {\r\n        this.setState({\r\n          orders: response.data,\r\n          isLoading: false,\r\n          checkoutError: null\r\n        });\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n        this.setState({\r\n          isLoading: false,\r\n          checkoutError: 'Failed to load cart items.'\r\n        });\r\n      });\r\n  }\r\n\r\n  calculateTotal() {\r\n    return this.state.orders.reduce((sum, order) => sum + (order.price * order.quantity), 0);\r\n  }\r\n\r\n  checkout() {\r\n    if (!this.state.orders || this.state.orders.length === 0) {\r\n      this.setState({ checkoutError: 'Your cart is empty.' });\r\n      return;\r\n    }\r\n\r\n    const total = this.calculateTotal();\r\n    if (total <= 0) {\r\n      this.setState({ checkoutError: 'Invalid order total.' });\r\n      return;\r\n    }\r\n\r\n    this.setState({ isCheckingOut: true, checkoutError: null });\r\n    axios.post(\"/api/order/checkoutAll\", {\r\n      orders: this.state.orders,\r\n      total: total\r\n    })\r\n    .then(response => {\r\n      this.setState({ isCheckingOut: false });\r\n      if (response.data && response.status === 200) {\r\n        alert('Orders successfully checked out!');\r\n        this.getCartOrders();\r\n      }\r\n    })\r\n    .catch(err => {\r\n      console.log(err);\r\n      const errorMessage = err.response?.data?.message || 'Error during checkout. Please try again.';\r\n      this.setState({ \r\n        isCheckingOut: false,\r\n        checkoutError: errorMessage\r\n      });\r\n    });\r\n  }\r\n\r\n  render() {\r\n    if (this.state.isLoading) {\r\n      return <Typography>Loading cart...</Typography>;\r\n    }\r\n\r\n    return this.props.currentUser && this.state.orders ? (\r\n      <div>\r\n        <Grid container justify=\"space-evenly\" spacing={3}>\r\n          {this.state.orders.length > 0 ? this.state.orders.map(order => (\r\n            <Grid item key={order.id} xs={5}>\r\n              <OrderCard order={order} userType={this.props.currentUser.type} getOrders={this.getCartOrders} />\r\n            </Grid>\r\n          )) : <Typography variant=\"h5\"><i>Your Shopping Cart is Empty...</i></Typography>}\r\n          {this.state.orders.length > 0 && (\r\n            <Grid item xs={12}>\r\n              <div className=\"checkoutBox\">\r\n                <Grid container justify=\"flex-end\" spacing={2}>\r\n                  <Grid item xs={12}>\r\n                    <Typography variant=\"h6\" align=\"right\">\r\n                      Total: ${this.calculateTotal().toFixed(2)}\r\n                    </Typography>\r\n                  </Grid>\r\n                  {this.state.checkoutError && (\r\n                    <Grid item xs={12}>\r\n                      <Typography color=\"error\" align=\"right\">\r\n                        {this.state.checkoutError}\r\n                      </Typography>\r\n                    </Grid>\r\n                  )}\r\n                  <Grid item>\r\n                    <Button \r\n                      variant=\"outlined\" \r\n                      color=\"secondary\" \r\n                      size=\"medium\" \r\n                      onClick={this.checkout}\r\n                      disabled={this.state.isCheckingOut || this.state.orders.length === 0}\r\n                    >\r\n                      {this.state.isCheckingOut ? 'Processing...' : 'Check out all orders'}\r\n                    </Button>\r\n                  </Grid>\r\n                </Grid>\r\n              </div>\r\n            </Grid>\r\n          )}\r\n        </Grid>\r\n      </div>\r\n    ) : <div />\r\n  }\r\n}\r\n\r\nexport default ShopCart;"]},"metadata":{},"sourceType":"module"}